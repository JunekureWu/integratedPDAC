# Four target expression across cell types and in cell type-specific tissues
### scRNA analysis
```
#Fig S10A left
col4 <- rocket(50)
p<-DotPlot(PDAC_scRNA,features = "POSTN",group.by = 'celltype',assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                                   mid = col4[50],
                                                                                                                   high = col4[20])
pdf("result/cell_type_POSTN_dotplot.pdf",width = 4,height = 3)
print(p)
dev.off()

#Fig S10A right
p<-DotPlot(PDAC_scRNA,features = "POSTN",group.by = 'site',idents = "Fibroblast",assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                    mid = col4[50],
                                                                                                    high = col4[20])
pdf("result/tissue_POSTN_dotplot.pdf",width = 4.5,height = 3)
print(p)
dev.off()


#Fig S10B left
p<-DotPlot(PDAC_scRNA,features = "SPP1",group.by = 'celltype',assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                    mid = col4[50],
                                                                                                    high = col4[20])
pdf("result/cell_type_SPP1_dotplot.pdf",width = 4,height = 3)
print(p)
dev.off()

#Fig S10B right
p<-DotPlot(PDAC_scRNA,features = "SPP1",group.by = 'site',idents = "Macro/Mono",assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                   mid = col4[50],
                                                                                                   high = col4[20])
pdf("result/tissue_SPP1_dotplot.pdf",width = 4.5,height = 3)
print(p)
dev.off()

#Fig S10E left
p<-DotPlot(PDAC_scRNA,features = "CCL4",group.by = 'celltype',assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                    mid = col4[50],
                                                                                                    high = col4[20])
pdf("result/cell_type_CCL4_dotplot.pdf",width = 4,height = 3)
print(p)
dev.off()
#Fig S10E right
p<-DotPlot(PDAC_scRNA,features = "CCL4",group.by = 'site',idents = "T/NK",assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                   mid = col4[50],
                                                                                                   high = col4[20])
pdf("result/tissue_CCL4_dotplot.pdf",width = 4.5,height = 3)
print(p)
dev.off()



#Fig S10F left
p<-DotPlot(PDAC_scRNA,features = "IGHG1",group.by = 'celltype',assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                   mid = col4[50],
                                                                                                   high = col4[20])
pdf("result/cell_type_IGHG1_dotplot.pdf",width = 4,height = 3)
print(p)
dev.off()
#Fig S10F right
p<-DotPlot(PDAC_scRNA,features = "IGHG1",group.by = 'site',idents = "B/Plasma",assay = "SCT")+scale_color_gradient2(low = 'white',
                                                                                                               mid = col4[50],
                                                                                                               high = col4[20])
pdf("result/tissue_IGHG1_dotplot.pdf",width = 4.5,height = 3)
print(p)
dev.off()
```
### bulk RNA analysis of expression between tumor and normal tissues
### This part of the boxplot was generated by Tenghui Dai. The following code examples demonstrate different targets and datasets.
```
####boxplot tumor & normal ########

###tumor_symbol data ./gsva/exp
###all_symbol data ./gsva/exp/all_symbol
#GSE78229 as a example
expr <-read.table(paste("./gsva/exp/",'GSE78229',sep = ''),sep = '\t')
expr <- expr[c('POSTN','SPP1','CCL4','IGHG1'),]
expr_all <-read.table(paste("./gsva/exp/all_symbol/",'GSE78229',sep = ''),sep = '\t')
expr_all <- expr_all[c('POSTN','SPP1','CCL4','IGHG1'),]

##正常样本和tumor样本
#tumor symbol
t_sample<-colnames(expr)
#normal symbol
n_sample<-setdiff(colnames(expr_all), colnames(expr))#取所有和肿瘤的差

##分group
da<-as.data.frame(t(expr_all))
da$group<-ifelse(rownames(da) %in% n_sample, "normal", "tumor")
da <- da[order(da$group), ]

da1<-as.data.frame(da)
da<-da1
for (j in 1:(dim(da)-1)[2]) {
    da[[i]][,j]<-log2(da[[i]][,j]+1)
}
da<- as.data.frame(da)

######plot######
library(ggpubr)
dir.create("/Users/dth/Downloads/PDAC_WJ_data/box/")
{
    
    {
        dir=paste("/Users/dth/Downloads/PDAC_WJ_data/box/",'GSE78229','/',sep = '')
        dir.create(dir)
        p<-list()
        #######SPP1####
        p[[1]] <- ggboxplot(da,x="group",y="SPP1", xlab  = "", ylab  = "log2(count +1)",
                            color = "group", palette = c("tumor" = "#DC0000CC", "normal" = "#3C5488CC"), 
                            add = "jitter",lwd=0.8,width = 0.8,
                            title = paste('GSE78229',"SPP1-","boxplot",sep = ' '))+theme_bw()+# 
            stat_compare_means(aes(group = group),
                               method = "wilcox.test",label = "p.signif",
                               label.x = 1.5,lwd=10,label.y = 4)+
            theme(axis.title= element_text(size=15),
                  legend.text= element_text(size=14),
                  #legend.position = 'none',#
                  axis.text.y= element_text(size=14,color="black", vjust=0.5, hjust=0.5),
                  axis.text.x= element_text(size=14,color="black", vjust=0.5, hjust=0.5),
                  axis.line.x=element_line(linetype=1,color="black",size=1),
                  axis.line.y=element_line(linetype=1,color="black",size=1),
                  axis.ticks.x=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.y=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.length = unit(0.25, "cm"))
        #p[[1]]<-p[[1]] + scale_x_discrete(limits = c("tumor", "normal"))
        pdf(file = paste(dir,'GSE78229',"-",'SPP1-box',".pdf",sep =''),width = 4.6,height = 4.6,onefile = F)
        print(p[[1]])
        dev.off()
    }
    ######POSTN####
    {
        p[[2]] <- ggboxplot(da,x="group",y="POSTN", xlab  = "", ylab  = "log2(count +1)",
                            color = "group", palette = c("tumor" = "#DC0000CC", "normal" = "#3C5488CC"), 
                            add = "jitter",lwd=0.8,width = 0.8,
                            title = paste('GSE78229',"POSTN-","boxplot",sep = ' '))+theme_bw()+#
            stat_compare_means(aes(group = group),
                               method = "wilcox.test",label = "p.signif",
                               label.x = 1.5,lwd=10,label.y = 4)+
            theme(axis.title= element_text(size=15),
                  legend.text= element_text(size=14),
                  #legend.position = 'none',#
                  axis.text.y= element_text(size=14,color="black", vjust=0.5, hjust=0.5),
                  axis.text.x= element_text(size=14,color="black", vjust=0.5, hjust=0.5),
                  axis.line.x=element_line(linetype=1,color="black",size=1),
                  axis.line.y=element_line(linetype=1,color="black",size=1),
                  axis.ticks.x=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.y=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.length = unit(0.25, "cm"))
        #p[[1]]<-p[[1]] + scale_x_discrete(limits = c("tumor", "normal"))
        pdf(file = paste(dir,'GSE78229',"-",'POSTN-box',".pdf",sep =''),width = 5,height = 5,onefile = F)
        print(p[[2]])
        dev.off()
    }
    ######CCL4####
    {
        p[[3]] <- ggboxplot(da,x="group",y="CCL4", xlab  = "", ylab  = "log2(count +1)",
                            color = "group", palette = c("tumor" = "#DC0000CC", "normal" = "#3C5488CC"), 
                            add = "jitter",lwd=0.8,width = 0.8,
                            title = paste('GSE78229',"CCL4-","boxplot",sep = ' '))+theme_bw()+# 
            stat_compare_means(aes(group = group),
                               method = "wilcox.test",label = "p.signif",
                               label.x = 1.5,lwd=10,label.y = 4)+
            theme(axis.title= element_text(size=15),#
                  legend.text= element_text(size=14),#
                  #legend.position = 'none',#去掉legend
                  axis.text.y= element_text(size=14,color="black", vjust=0.5, hjust=0.5),#
                  axis.text.x= element_text(size=13,color="black", vjust=0.5, hjust=0.5),
                  axis.line.x=element_line(linetype=1,color="black",size=1),
                  axis.line.y=element_line(linetype=1,color="black",size=1),
                  axis.ticks.x=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.y=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.length = unit(0.25, "cm"))#
        #p[[1]]<-p[[1]] + scale_x_discrete(limits = c("tumor", "normal"))
        pdf(file = paste(dir,'GSE78229',"-",'CCL4-box',".pdf",sep =''),width = 4.6,height = 4.6,onefile = F)
        print(p[[3]])
        dev.off()
    }
    ######IGHG1####
    {
        p[[4]] <- ggboxplot(da,x="group",y="IGHG1", xlab  = "", ylab  = "log2(count +1)",
                            color = "group", palette = c("tumor" = "#DC0000CC", "normal" = "#3C5488CC"), 
                            add = "jitter",lwd=0.8,width = 0.8,
                            title = paste('GSE78229',"IGHG1-","boxplot",sep = ' '))+theme_bw()+#
            stat_compare_means(aes(group = group),
                               method = "wilcox.test",label = "p.signif",
                               label.x = 1.5,lwd=10,label.y = 4)+
            theme(axis.title= element_text(size=15),#
                  legend.text= element_text(size=14),#
                  #legend.position = 'none',#
                  axis.text.y= element_text(size=14,color="black", vjust=0.5, hjust=0.5),#
                  axis.text.x= element_text(size=14,color="black", vjust=0.5, hjust=0.5),
                  axis.line.x=element_line(linetype=1,color="black",size=1),#
                  axis.line.y=element_line(linetype=1,color="black",size=1),
                  axis.ticks.x=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.y=element_line(color="black",size=1,lineend = 1),
                  axis.ticks.length = unit(0.25, "cm"))#
        pdf(file = paste(dir,'GSE78229',"-",'IGHG1-box',".pdf",sep =''),width = 5,height = 5,onefile = F)
        print(p[[4]])
        dev.off()
    }
}
```
